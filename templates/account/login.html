{% extends "base/base.html" %}

{% block title %}Login &mdash; {{ block.super }}{% endblock %}
{% block subtitle %}Login{% endblock %}

{% block container %}

{% if form.non_field_errors %}
<div class="alert alert-danger mb-5">
  <h4 class="alert-heading">
    Login error
  </h4>
  <hr>
  {% for x in form.non_field_errors %}
    <p class="mb-1">{{ x }}</p>
  {% endfor %}
</div>
{% endif %}

<form
  method="POST"
  class=""
  action=""
  {% if form.is_multipart %}enctype="multipart/form-data"{% endif %}
>
  {% csrf_token %}

    {{ wizard.management_form }}

    {% switch wizard.steps.current %}

    {% case "auth" %}

      <div class="form-group">
        <label class="col-form-label" for="{{ form.email.id_for_label }}">
          Email address
        </label>
        <input
          id="{{ form.email.id_for_label }}"
          type="email"
          class="form-control {% if form.errors %}{% if form.errors.email %}is-invalid{% else %}{% if not form.non_field_errors %}is-valid{% endif %}{% endif %}{% endif %}"
          name="{{ form.email.html_name }}"
          value="{{ form.email.value|default:"" }}"
          maxlength="{{ form.email.field.max_length|default:"" }}"
          placeholder="Enter your email address"
          {% if form.email.field.required %}required{% endif %}
        >
        {% for x in form.errors.email %}
          <div class="invalid-feedback">{{ x }}</div>
        {% endfor %}
      </div>

      <div class="form-group">
        <label class="col-form-label" for="{{ form.password.id_for_label }}">
          Password
        </label>
        <input
          id="{{ form.password.id_for_label }}"
          type="password"
          class="form-control {% if form.errors %}{% if form.errors.password %}is-invalid{% else %}{% if not form.non_field_errors %}is-valid{% endif %}{% endif %}{% endif %}"
          name="{{ form.password.html_name }}"
          value=""
          maxlength="{{ form.password.field.max_length|default:"" }}"
          placeholder="Enter your password"
          {% if form.password.field.required %}required{% endif %}
        >
        {% for x in form.errors.password %}
          <div class="invalid-feedback">{{ x }}</div>
        {% endfor %}
      </div>

      <button type="submit" class="btn btn-primary my-4">
        Login
      </button>

      <p>
        If you do not have an account, <a href="{% url "registration:view" %}">please register</a>.
      </p>

      <p>
        <a href="{% url "account:reset-password:view" %}">Forgot your password?</a>
      </p>

    {% endcase %}

    {% case "token" %}
      <div class="form-group">
        <label for="{{ form.otp_token.id_for_label }}">
          Token
        </label>
        <input
          id="{{ form.otp_token.id_for_label }}"
          type="number"
          class="form-control {% if form.errors %}{% if form.errors.otp_token %}is-invalid{% else %}{% if not form.non_field_errors %}is-valid{% endif %}{% endif %}{% endif %}"
          name="{{ form.otp_token.html_name }}"
          value="{{ form.otp_token.value|default:"" }}"
          maxlength="{{ form.otp_token.field.max_length|default:"" }}"
          {% if form.otp_token.field.required %}required{% endif %}
        >
        {% for x in form.errors.otp_token %}
          <div class="invalid-feedback">{{ x }}</div>
        {% empty %}
          <small class="form-text text-muted">
            Please enter the token generated by your token generator.
          </small>
        {% endfor %}
      </div>

      <button type="submit" class="btn btn-primary my-4">
        Login
      </button>
    {% endcase %}

    {% endswitch %}
</form>

{% endblock %}
